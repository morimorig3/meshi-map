# プロダクト要求定義書 (Product Requirements Document)

## プロダクト概要

### 名称

**めしマップ** - 自分だけの食体験を地図に記録するアプリ

### プロダクトコンセプト

- **MAP中心の体験**: 食べた場所・行きたい場所が地図上に可視化され、現在地との関係が一目でわかる
- **自分だけの記録**: 他人のレビューに惑わされない、パーソナルな食体験の蓄積
- **シンプルさの追求**: 余計な機能を排除し、「記録する」「思い出す」に特化

### プロダクトビジョン

「お腹空いたなぁ」と思った瞬間に、過去の美味しかった店や行きたかった店を地図上で発見できる世界を目指す。
食べログやGoogleマップのような大量の情報ではなく、自分自身の食体験だけを記録・参照できるシンプルなツールを提供する。
ユーザーが自分の「食の軌跡」を振り返り、新しい食体験への一歩を踏み出せるようサポートする。

### 目的

- 過去に訪れた飲食店を地図上で視覚的に記録・管理できるようにする
- 現在地から近い「行ったことのある店」「行きたい店」を素早く発見できるようにする
- 食体験の記録を通じて、ユーザーの「また行きたい」「行ってみたい」を実現する

## ターゲットユーザー

### プライマリーペルソナ: 佐藤健太（28歳、ITエンジニア）

- 都内在住、一人暮らし
- 外食が多く、週に3-4回は外で食事をする
- 「あの店美味しかったな、また行きたい」と思うことが多いが、店名や場所を忘れがち
- 食べログやGoogleマップは情報過多で、自分の記録を探すのが面倒
- スマートフォンでサクッと使えるシンプルなアプリを好む

**現在の課題**:

- 美味しかった店を覚えておく手段がない（メモアプリは続かない）
- 「この辺で何か食べたい」時に、過去の経験を活かせない
- 友人に「おすすめの店ある？」と聞かれても、とっさに思い出せない

**期待する解決策**:

- 店を訪れたらサクッと記録できる
- 地図を開けば過去に行った店が一目でわかる
- 現在地から近い記録済みの店をすぐ見つけられる

**1日の典型的なワークフロー**:

1. 昼休み、オフィス周辺で「今日何食べよう」と考える
2. アプリを開き、現在地周辺の記録済み店舗を確認
3. 「あ、ここ美味しかったな」と思い出し、その店に向かう
4. 新しい店に行った場合、食後にアプリで店舗を検索・登録

## 成功指標（KPI）

### プライマリーKPI

- **週次アクティブユーザー（WAU）**: 50人（リリース3ヶ月後）
  - 測定方法: アプリへのアクセスログ
- **店舗登録数**: ユーザーあたり平均10店舗（リリース3ヶ月後）
  - 測定方法: データベースの店舗登録数 / ユーザー数
- **リピート利用率**: 週1回以上利用するユーザー60%以上
  - 測定方法: 週次アクセスログ分析

### セカンダリーKPI

- **店舗検索から登録までの完了率**: 70%以上
  - 測定方法: 検索開始イベント → 登録完了イベントの遷移率
- **地図表示時の滞在時間**: 平均30秒以上
  - 測定方法: 地図画面の表示時間

## 機能要件

### コア機能（MVP）

#### 店舗検索

**ユーザーストーリー**:
ユーザーとして、訪れた店舗を記録するために、店名で店舗を検索したい

**受け入れ条件**:

- [ ] フリーワードで店舗名を検索できる
- [ ] 検索結果に店舗名、住所、カテゴリが表示される
- [ ] 検索結果から店舗を選択して詳細を確認できる
- [ ] 検索結果が0件の場合、適切なメッセージが表示される
- [ ] 検索中はローディング状態が表示される

**優先度**: P0（必須）

#### 店舗登録

**ユーザーストーリー**:
ユーザーとして、訪れた店舗を自分のリストに追加するために、検索結果から店舗を登録したい

**受け入れ条件**:

- [ ] 検索結果の店舗を「登録」ボタンで保存できる
- [ ] 登録時に店舗の座標情報が保存される
- [ ] 登録完了後、確認メッセージが表示される
- [ ] 既に登録済みの店舗は「登録済み」と表示される
- [ ] 登録した店舗は即座に地図上に反映される

**優先度**: P0（必須）

#### 店舗登録解除

**ユーザーストーリー**:
ユーザーとして、間違えて登録した店舗や不要になった店舗をリストから削除したい

**受け入れ条件**:

- [ ] 登録済み店舗を「登録解除」ボタンで削除できる
- [ ] 削除前に確認メッセージが表示される
- [ ] 削除完了後、地図上からマーカーが即座に消える
- [ ] 自分が登録した店舗のみ削除可能（他ユーザーの登録は削除不可）

**優先度**: P0（必須）

#### データ管理（MVP）

**ユーザーストーリー**:
ユーザーとして、登録した店舗データを確実に保存し、次回起動時も利用したい

**受け入れ条件**:

- [ ] 初回起動時に匿名ユーザーIDが自動生成される
- [ ] 店舗登録データは匿名ユーザーIDに紐付けてサーバーに保存される
- [ ] ブラウザを閉じても、同一ブラウザであればデータが維持される
- [ ] データ消失リスク（ブラウザキャッシュクリア等）について初回起動時に通知する

**制約事項**:

- ブラウザのローカルストレージをクリアすると匿名ユーザーIDが失われ、データにアクセスできなくなる
- 異なるブラウザ・デバイス間でのデータ同期は不可（P1のユーザー認証で対応）

**優先度**: P0（必須）

#### 地図表示

**ユーザーストーリー**:
ユーザーとして、登録した店舗の位置関係を把握するために、地図上で店舗を確認したい

**受け入れ条件**:

- [ ] 地図画面で登録済み店舗がマーカー（点）として表示される
- [ ] 現在地が地図上に表示される
- [ ] 地図のズーム・スクロール操作ができる
- [ ] 初期表示は現在地を中心とする

**優先度**: P0（必須）

#### 店舗詳細表示

**ユーザーストーリー**:
ユーザーとして、登録した店舗の情報を確認するために、マーカーをタップして詳細を見たい

**受け入れ条件**:

- [ ] マーカーをタップすると店舗情報がポップアップ表示される
- [ ] ポップアップには店舗名が表示される
- [ ] ポップアップにはURL（Google Maps等へのリンク）が表示される
- [ ] ポップアップには食べ物の画像が表示される（画像がある場合）

**優先度**: P0（必須）

### 画面構成

```
[ホーム画面 / 地図画面]
├── 地図表示エリア
│   ├── 現在地マーカー
│   └── 登録店舗マーカー（タップで詳細表示）
├── 検索ボタン / 検索バー
└── 下部ナビゲーション（将来拡張用）

[検索画面]
├── 検索入力フォーム
├── 検索結果リスト
│   ├── 店舗名
│   ├── 住所
│   ├── カテゴリ
│   └── 登録ボタン
└── 戻るボタン

[店舗詳細ポップアップ]
├── 店舗名
├── 店舗画像
├── 外部リンク（Google Maps等）
└── 閉じるボタン
```

### 将来的な機能（Post-MVP）

#### 都道府県フィルタリング

登録店舗を都道府県で絞り込み表示できる

**優先度**: P2（できれば）

#### 食べ物の種類フィルタリング

登録店舗を料理カテゴリ（ラーメン、寿司、イタリアン等）で絞り込み表示できる

**優先度**: P2（できれば）

#### タグ付け機能

店舗に自由なタグを付けて分類・検索できる

**優先度**: P2（できれば）

#### メモ・レビュー機能

店舗に自分用のメモやレビューを記録できる

**優先度**: P2（できれば）

#### 画像アップロード

自分で撮影した写真を店舗に紐付けて保存できる

**優先度**: P2（できれば）

#### ユーザー認証

**ユーザーストーリー**:
ユーザーとして、複数デバイスでデータを同期し、データ消失を防ぎたい

**受け入れ条件**:

- [ ] メールアドレス+パスワードでアカウント登録できる
- [ ] 匿名ユーザーとして登録したデータをアカウントに移行できる
- [ ] 複数デバイスでログインし、同じデータにアクセスできる
- [ ] ログアウト機能がある

**優先度**: P1（重要）

## 非機能要件

### パフォーマンス

- 店舗検索結果表示: 3秒以内（Google Places API応答時間含む）
- 地図の初期表示: 2秒以内
- 登録店舗100件までスムーズに地図表示（フレーム落ちなし）

### ユーザビリティ

- 初回利用者が5分以内に店舗検索→登録→地図確認の流れを完了できる
- 主要操作（検索、登録、地図表示）は3タップ以内で到達できる
- モバイルファースト: スマートフォンでの操作を最優先に設計

### 信頼性

- 登録データの損失ゼロ（Supabaseの自動バックアップ活用）
- API障害時は適切なエラーメッセージを表示し、アプリがクラッシュしない
- オフライン時は地図のキャッシュ表示と「オフラインです」メッセージを表示

### セキュリティ

- Google Places APIキーはバックエンド（Cloudflare Workers）で管理し、フロントエンドに露出させない
- フロントエンドからSupabaseを直接呼び出さず、バックエンドAPI経由でアクセス
- HTTPS通信を必須とする

### スケーラビリティ

- 初期は無料枠内での運用を想定（ユーザー数100人程度まで）
- 無料枠を超過した場合はサービスを一時停止し、予期せぬ課金を防止
- モノレポ構成により、将来のモバイルアプリ（React Native等）への展開が可能

### コスト制約

- Cloudflare Pages/Workers: 無料枠内で運用
- Supabase: 無料枠内で運用
- Google Places API: 月間$200の無料クレジット内で運用
- クレジットカード登録なしで開始できる構成を維持

## スコープ外

明示的にスコープ外とする項目:

- ナビゲーション機能（店舗への道案内）
- ソーシャル機能（他ユーザーとの共有、フォロー）
- 予約機能
- クーポン・ポイント機能
- 店舗側の管理機能
- 広告表示
- 有料プラン
